
=== 투자 설정 ===
투자 금액: 10,000,000원
사용 장치: cuda
데이터 다운로드 중 (005930.KS, ^VIX)...
기술적 지표 및 재무 지표 계산 중...
분기별 재무제표 가져오는 중...
... 재무제표에 2개월 공시 지연(lag) 적용 ...
애널리스트 추천 정보 (시계열) 가져오는 중...
시장 감성 지표 계산 중...
--- 데이터 처리 완료 (정규화 전) ---
총 2664일의 데이터
사용된 지표 (총 23개): ATR, AnalystRating, Bollinger_B, Close, DebtRatio, High, Low, MACD, MACD_Signal, Market_Strength, Price_Acceleration, Price_Momentum_20, Price_Momentum_5, Price_Volatility, ROA, RSI, SMA20, Stoch_D, Stoch_K, VIX, VIX_Change, Volume, Volume_Ratio
  - Agent 0 (단기): 9개
  - Agent 1 (장기): 11개
  - Agent 2 (위험): 7개
  - Agent 3 (감성): 11개

--- 데이터 분할 정보 ---
전체 데이터: 2664일
학습 데이터: 2412일 (2015-01-06 00:00:00 ~ 2024-10-31 00:00:00)
백테스팅 데이터: 252일 (2024-11-01 00:00:00 ~ 2025-11-17 00:00:00)
데이터 정규화 중 (Train-Test 분리 적용)...

--- QMIX 500 에피소드 학습 시작 (총 지표: 23개) ---
--- Obs 차원: A0=92 (단기), A1=112 (장기), A2=72 (위험), A3=112 (감성) | 글로벌 상태 차원: 238 ---
Episode 1/500 | Epsilon: 0.952 | Team Reward: 67.51
Episode 2/500 | Epsilon: 0.904 | Team Reward: 326.61
Episode 3/500 | Epsilon: 0.856 | Team Reward: 195.09
Episode 4/500 | Epsilon: 0.808 | Team Reward: 247.10
Episode 5/500 | Epsilon: 0.760 | Team Reward: 135.59
Episode 6/500 | Epsilon: 0.712 | Team Reward: 266.40
Episode 7/500 | Epsilon: 0.664 | Team Reward: 13.90
Episode 8/500 | Epsilon: 0.616 | Team Reward: 335.02
Episode 9/500 | Epsilon: 0.568 | Team Reward: 19.81
Traceback (most recent call last):
  File "/home/yb_ai/1126_4agent/2025-2-CSC4004-1-7-Libri/AI/marl_4agent/main.py", line 514, in <module>
    main()
  File "/home/yb_ai/1126_4agent/2025-2-CSC4004-1-7-Libri/AI/marl_4agent/main.py", line 342, in main
    learner.train(buffer)
  File "/home/yb_ai/1126_4agent/2025-2-CSC4004-1-7-Libri/AI/marl_4agent/qmix_model.py", line 176, in train
    q_chosen = torch.gather(q_values_all, dim=1, index=a[i])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
